FROM python:3.12-slim

WORKDIR /app

# Install test dependencies only (without the app package itself)
COPY pyproject.toml .
COPY src/ src/

# Install in editable mode so Python uses /app/src/ (mountable via volume)
RUN pip install --no-cache-dir -e ".[test]"

ENV PYTHONUNBUFFERED=1

ENTRYPOINT ["pytest"]
CMD ["tests/", "-v", "--tb=short", "--timeout=60"]
